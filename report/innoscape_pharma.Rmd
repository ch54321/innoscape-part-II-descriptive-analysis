---
output: 
   html_document:
      css: style.css
runtime: shiny
fig_caption: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(ggplot2)
library(xtable)
library(DT)
library(viridis)
library(RColorBrewer)
library(knitr)
library(png)
library(cowplot)
library(plotly)
library(viridis)
library(autoimage)
library(shinyWidgets)
library(plyr)
library(dplyr)
library(data.table)
library("countrycode")
library("visNetwork")
source_rmd <- function(rmd_file){
  knitr::knit(rmd_file, output = tempfile())
}
```

<!-- # ```{r, context="data", include=FALSE} -->
<!-- # # Load data  -->
<!-- # dat_ii <- readRDS("num_pat_16.rds") %>% data.frame()  -->
<!-- # dat_ii <- filter(dat_ii, p_year < 2016) -->
<!-- # dat_ii <- setDT(dat_ii)[, ges_pat_geo := sum(share_inv[indicator == "abs"]), .(geo)] -->
<!-- # dat_ii <- setDT(dat_ii)[, `Rank based on total patents` := dense_rank(desc(ges_pat_geo)), .(geo_level)] -->
<!-- # dat_ii <- as.data.frame(dat_ii)   -->
<!-- #  -->
<!-- # tradedata <- readRDS("oecd_trade_ch_final.rds") -->
<!-- # labprod <- readRDS("lab_prod_final_ch.rds") -->
<!-- # gva <- readRDS("gva_data_ch.rds") -->
<!-- # ilo <- readRDS("iloemp_2020_final.rds") -->
<!-- # ilo <- subset(ilo,ind.code=="21") -->
<!-- # ``` -->


```{r, context="data", include=FALSE}
# Load data 
dat_ii <- readRDS("num_pat_16.rds") %>% data.frame() 
dat_ii <- filter(dat_ii, p_year < 2016)
dat_ii <- setDT(dat_ii)[, ges_pat_geo := sum(share_inv[indicator == "abs"]), .(geo)]
dat_ii <- setDT(dat_ii)[, `Rank based on total patents` := dense_rank(desc(ges_pat_geo)), .(geo_level)]
dat_ii <- as.data.frame(dat_ii)  
tradedata <- readRDS("oecd_trade_ch_final.rds")
labprod <- readRDS("lab_prod_final_ch.rds")
gva <- readRDS("gva_data_ch.rds")
ilo <- readRDS("iloemp_2020_final.rds")
ilo <- subset(ilo,ind.code=="21")

numpat_data <- readRDS("num_pat_16.rds")
citflow <- readRDS("back_citations_16.rds")
techlab <- readRDS("oecd_tech_field.RDS")
colnames(techlab) <- c("tech_field_cited", "tech_name")
citflow_final <- merge(citflow, techlab)
```	

<!-- <head> -->
<!-- <!-- Global site tag (gtag.js) - Google Analytics --> -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=UA-71167447-1"></script> -->
<!-- <script> -->
<!--   window.dataLayer = window.dataLayer || []; -->
<!--   function gtag(){dataLayer.push(arguments);} -->
<!--   gtag('js', new Date()); -->
<!--   gtag('config', 'UA-71167447-1'); -->
<!-- </script> -->
<!-- </head> -->


<br>

[![Foo](cieb_logo.jpg){ width=18% }](http://cieb.unibas.ch/)&nbsp;&nbsp;

## <font color="grey"> **Innoscape: Descriptive Analysis of Pharma Innovations** </font>

*June 2020* <a href="https://cieb.unibas.ch/de/team/dragan-filimonovic/" target = "_blank">Dragan Filimonovic</a>, <a href="https://cieb.unibas.ch/de/team/matthias-niggli/" target = "_blank">Matthias Niggli</a> and <a href="https://cieb.unibas.ch/de/team/dr-christian-rutzer/" target = "_blank">Christian Rutzer</a>


<br>
<br>

#### <font color='grey'> **Development of the Pharma Sector in Switzerland ** </font>


<br>
<br>



### Value added
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "gva_output.Rmd")}
```

### Employment
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "emp_output.Rmd")}
```

### Labor productivity
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "labprod_output.Rmd")}
```

### Exports
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "export_output.Rmd")}
```

### Patent count and shares
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "numpat_output.Rmd")}
```

### Citations
```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "citnetwork_output.Rmd")}
```

## {.tabset}

### Continents

```{r, echo = F, child = file.path(knitr::opts_knit$get("output.dir"), "conti_func.RMD")}
```

HERE short description of the findings at the continent level


### Countries

```{r, echo = F, child  = file.path(knitr::opts_knit$get("output.dir"), "ctry_func.Rmd")}
```




HERE short description of the findings at the country level


### Regions

```{r, echo = F, child  = file.path(knitr::opts_knit$get("output.dir"),'regio_func.Rmd')}
```




HERE short description of the findings at the regional level

## {.unlisted .unnumbered}