
```{r, echo=FALSE}


# Input panels for indicator and industry
radioButtons("variable_gva", "Choose a variable",
          choices = list("GVA in millions CHF"="gva_abs", 
                         "Share in total GVA"="gva_share",
                         "GVA percentage change"="gva_prchange"),
          selected = "gva_share")
          
    selectizeInput("ind.name_gva", "Choose industry",
          choices = c(gva$ind.name),multiple = TRUE, selected = "Manufacture of basic pharmaceutical products and pharmaceutical preparations")
    

  renderPlotly({

# subset the data accoding to the input:
  dr <- reactive({ gva %>%
                    filter(variable %in% input$variable_gva,
                           ind.name %in% input$ind.name_gva)
      }) 

# make the plot
  ggplotly(  
    ggplot(dr(),aes(x = as.numeric(year), y = value, group = ind.name, colour = ind.name)) +
        geom_point(alpha = 0.7) +  
            geom_line()+
            xlab("Year")+
            ylab(input$variable_gva)+
            guides(color = FALSE)+
            scale_x_continuous(breaks = seq(min(dr()$year), max(dr()$year), by = 5)) +
                 theme(axis.title = element_text(face="bold",size = 10),
                       panel.background = element_blank(),
                       axis.line = element_line()
                       ), dynamicTicks = T) %>%
                          config(displayModeBar = F) %>%
                          layout(xaxis = list(fixedrange=F, 
                          rangeslider = list(type = "date", visible=T))) %>%
                          layout(yaxis = list(fixedrange=F)
      )
    
  })

```
