
```{r, echo=FALSE}
# Input panels for indicator and industry
radioButtons(inputId = "variable_gva", label = "Choose a variable",
          choices = list("Share in GDP" = "Share in GDP",
                         "GVA in millions CHF" = "GVA in millions CHF", 
                         "GVA percentage change" = "GVA percentage change"),
          selected = "Share in GDP", 
          inline = T)

  pickerInput(inputId = "ind.name_gva",
              label = "Choose industries", 
              choices= sort(unique(gva$ind.name)),
              selected = "Pharmaceutical products",
              options = list(`actions-box` = TRUE),
              multiple = TRUE)

renderPlotly({

  # subset the data according to the input:
  d_gva <- reactive({ gva %>%
                    filter(variable %in% input$variable_gva,
                           ind.name %in% input$ind.name_gva)
      })
  
 

if(nrow(d_gva()) != 0){
    # specify y axis title
  Y_AXIS_TITLE <- if(input$variable_gva == "Share in GDP"){"Share in GDP (in %)"}else{
    if(input$variable_gva == "GVA in millions CHF"){"GVA (in millions CHF)"}else{
      "GVA change (in %)"}}
  
# make the plot
  ggplotly(  
    ggplot(d_gva(),aes(x = as.numeric(year), y = value, group = ind.name, colour = ind.name, label = Industry)) +
        geom_point(alpha = 0.7) +  
            geom_line()+
            scale_colour_brewer(palette = "RdBu") +
            xlab("Year")+
            ylab(Y_AXIS_TITLE)+
            guides(color = FALSE)+
            scale_x_continuous(breaks = seq(min(d_gva()$year), max(d_gva()$year), by = 5)) +
                 theme(axis.title = element_text(face="bold",size = 10),
                       panel.background = element_blank(),
                       axis.line = element_line(),
                       legend.position="bottom"
                       ), dynamicTicks = T,  tooltip = c("label")) %>%
                          config(displayModeBar = F) %>%
                          layout(xaxis = list(fixedrange=T, rangeslider = list(type = "date", visible=T)
                          )) %>%
                          layout(yaxis = list(fixedrange=T),
                                 legend = list(orientation = "h"))
    
  } else{}
  })

```
