
```{r, echo=FALSE}


# Input panels for indicator and industry

  checkboxGroupInput("variable_prod", "Choose a productivity indicator with:", 
                         choices = list("Only domestic workers"="Only domestic workers", 
                                        "Total jobs in firms"="Total jobs in firms",
                                        "Domestic and cross-border workers"="Domestic and cross-border workers"),
                         selected = "Only domestic workers",
                         inline = T)

  selectizeInput("ind.name_prod", "Choose industry",
                         choices = unique(labprod$ind.name),multiple = TRUE, selected = "Manufacture of pharmaceutical products")
    
  renderPlotly({

# subset the data according to the input:
  d_output <- reactive({labprod %>%
                        filter(variable %in% input$variable_prod,
                               ind.name %in% input$ind.name_prod)
      }) 

# make the plot
  ggplotly(  
           ggplot(d_output(),aes(x = as.numeric(year), y = value, group = interaction(ind.name, variable), colour = ind.name,linetype  = variable, label = Industry)) +
           geom_point(alpha = 0.7) +  
            geom_line()+
            xlab("Year")+
            ylab(input$variable_prod)+
            guides(color = FALSE)+
            scale_x_continuous(breaks = seq(min(d_output()$year), max(d_output()$year), by = 5)) +
            theme(axis.title = element_text(face="bold",size = 10),
                       panel.background = element_blank(),
                       axis.line = element_line()
                       ), dynamicTicks = T, tooltip = c("label")) %>%
                          config(displayModeBar = F) %>%
                          layout(xaxis = list(fixedrange=F, 
                          rangeslider = list(type = "date", visible=T))) %>%
                          layout(yaxis = list(fixedrange=F),
                                 legend = list(orientation = "h"))
    
  })

```
