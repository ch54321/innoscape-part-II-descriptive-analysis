```{r, echo=FALSE}

# Input panels for indicator, industry and year 
  radioButtons("variable_exp", "Choose a variable",
               choices = list("Swiss Pharma exports in million USD"="val_export", 
                              "% Share of pharma in destination imports from Switzerland"="share_in_tot",
                              "% of total Swiss Pharma Exports"="share_in_tot2"),
                                selected = "val_export", inline = T)

  sliderInput(inputId =  "year_exp", "Year", min=1994, max=2019, step = 5, value=1999, sep="")
  


  renderPlotly({

# subset the data accoding to the input:
    d_exp <- reactive({volumes %>%
                    filter(variable %in% input$variable_exp,
                           year %in% input$year_exp)
    }) 

# make the plot
  ggplotly(  
            ggplot() +
              geom_polygon(data = map_world,
                           aes(long, lat, group = group, fill = region), 
                           show.legend = FALSE,
                           alpha = 0.4,
                           fill="lightgreen",
                           color = "white") +
              geom_curve(data = d_exp(), 
                         aes(x = long_rep, xend = long_par,
                             y = lat_rep, yend = lat_par),
                         curvature = 0.1, 
                         col="turquoise2", 
                         size = 0.10,
                         alpha = 0.5) +
              geom_point(data = d_exp(),
                         aes(long_par, lat_par, size = value, label = Country), color = "chocolate1",alpha = 0.5) +
              theme_bw() +
              theme(axis.line = element_blank(),
                    panel.grid.major = element_blank(),
                    panel.grid.minor = element_blank(),
                    panel.background = element_blank(),
                    panel.border = element_blank(),
                    axis.ticks = element_blank(),
                    axis.title = element_blank(),
                    axis.text = element_blank()),
            dynamicTicks = T, tooltip = c("label")
      ) %>% config(displayModeBar = F) %>%
      layout(xaxis = list(fixedrange = TRUE), yaxis = list(fixedrange = TRUE))
    
  })

```

